.PHONY: ice/all ice/clean ice/depclean

ice/all: $(ICE_PY_SOURCES)

ice/clean:
	$(RM) $(ICE_CPP_SOURCES) $(ICE_OBJECTS) $(ICE_PY_SOURCES)
	$(RM) -r $(ICE_PY_MODDIR)

ice/depclean:
	$(RM) $(ICE_DEPS) $(ICE_HEADERS)

$(ICE_CPP_SOURCES) $(ICE_HEADERS) $(ICE_CPP_DEPS): FLAGS_SLICE2CPP := $(ICE_FLAGS_SLICE) $(ICE_FLAGS_SLICE2CPP) $(FLAGS_SLICE) $(FLAGS_SLICE2CPP)
$(ICE_PY_SOURCES) $(ICE_PY_DEPS): FLAGS_SLICE2PY := $(ICE_FLAGS_SLICE) $(ICE_FLAGS_SLICE2PY) $(FLAGS_SLICE) $(FLAGS_SLICE2PY)

$(ICE_PY_SOURCES): $(ICE_PY_MODDIR)
$(ICE_PY_MODDIR):
	$(MKDIR) $@

$(PYDIR)/%_ice.py: $(CURDIR)/%_ice.py
	$(LN) $< $@

$(ICE_IN_PYDIR_PY_MODDIR): $(ICE_PY_MODDIR)
	$(RM) -r $@
	$(CP) -rl $< $@

$(ICE_OBJECTS): FLAGS_PREPROCESSOR_CXX := $(FLAGS_PREPROCESSOR_CXX) $(ICE_FLAGS_PREPROCESSOR)

-include $(ICE_DEPS)
